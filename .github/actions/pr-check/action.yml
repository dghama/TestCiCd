name: Install dependencies

runs:
  using: 'composite'
  steps:
    - name: Run tests with coverage
      run: yarn test --coverage
      shell: bash

    - name: Run type check
      run: yarn typecheck
      shell: bash

    - name: Check Environment Variable
      run: |
        echo "Current ENV value: ${LOAD_ENV}"
        if [[ "${LOAD_ENV}" != "DEVELOPMENT" ]]; then
          echo "Environment ${LOAD_ENV} variable ENV is not set to DEVELOPMENT. Exiting..."
          exit 1
        fi
      shell: bash

    - name: Set APP_NAME without username
      run: |
        chmod +x ./scripts/set_app_name.sh
        ./scripts/set_app_name.sh
      shell: bash
