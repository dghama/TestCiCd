

name: 'build ios'

runs:
  using: 'composite'
  steps:
- name: Install and Build SDK for iOS
  run: |
    yarn react-native bundle --platform ios --dev false --entry-file index.js --bundle-output ios/main.jsbundle --assets-dest ios
    cd ios && pod install

- name: Set up Xcode
  run: sudo xcode-select --switch /Applications/Xcode_15.3.app # Replace with your Xcode version

- name: Build iOS Release
  run: |
    cd ios
    xcodebuild -workspace YourApp.xcworkspace -scheme YourApp -sdk iphoneos -configuration Release -archivePath $PWD/build/YourApp.xcarchive archive

- name: Export iOS Archive
  run: |
    xcodebuild -exportArchive -archivePath $PWD/build/YourApp.xcarchive -exportOptionsPlist $PWD/ios/exportOptions.plist -exportPath $PWD/build

- name: Upload iOS Artifact
  uses: actions/upload-artifact@v3
  with:
    name: ios-release
    path: ios/build/*.ipa